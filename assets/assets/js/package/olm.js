// @license magnet:?xt=urn:btih:8e4f440f4c65981c5bf93c76d35135ba5064d8b7&dn=apache-2.0.txt Apache-2.0
// @source: https://gitlab.matrix.org/matrix-org/olm/-/tree/3.2.15

var Olm = (function() {
var olm_exports = {};
var onInitSuccess;
var onInitFail;

var Module = (() => {
  var _scriptName = typeof document != 'undefined' ? document.currentScript?.src : undefined;
  if (typeof __filename != 'undefined') _scriptName ||= __filename;
  return (
function(moduleArg = {}) {
  var moduleRtn;

var c=moduleArg,aa,ba,ca=new Promise((a,b)=>{aa=a;ba=b}),da="object"==typeof window,ea="function"==typeof importScripts,fa="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,f;if("undefined"!==typeof window)f=function(a){window.crypto.getRandomValues(a)};else if(module.exports){var ha=require("crypto");f=function(a){var b=ha.randomBytes(a.length);a.set(b)}}else throw Error("Cannot find global to attach library to");
if("undefined"!==typeof OLM_OPTIONS)for(var ia in OLM_OPTIONS)OLM_OPTIONS.hasOwnProperty(ia)&&(c[ia]=OLM_OPTIONS[ia]);c.onRuntimeInitialized=function(){k=c._olm_error();olm_exports.PRIVATE_KEY_LENGTH=c._olm_pk_private_key_length();onInitSuccess&&onInitSuccess()};c.onAbort=function(a){onInitFail&&onInitFail(a)};var ja=Object.assign({},c),l="",ka,la,ma;
if(fa){var fs=require("fs"),na=require("path");l=__dirname+"/";ka=(a,b)=>{a=oa(a)?new URL(a):na.normalize(a);return fs.readFileSync(a,b?void 0:"utf8")};ma=a=>{a=ka(a,!0);a.buffer||(a=new Uint8Array(a));return a};la=(a,b,d)=>{a=oa(a)?new URL(a):na.normalize(a);fs.readFile(a,void 0,(e,g)=>{e?d(e):b(g.buffer)})};process.argv.slice(2)}else if(da||ea)ea?l=self.location.href:"undefined"!=typeof document&&document.currentScript&&(l=document.currentScript.src),_scriptName&&(l=_scriptName),l.startsWith("blob:")?
l="":l=l.substr(0,l.replace(/[?#].*/,"").lastIndexOf("/")+1),ka=a=>{var b=new XMLHttpRequest;b.open("GET",a,!1);b.send(null);return b.responseText},ea&&(ma=a=>{var b=new XMLHttpRequest;b.open("GET",a,!1);b.responseType="arraybuffer";b.send(null);return new Uint8Array(b.response)}),la=(a,b,d)=>{if(oa(a)){var e=new XMLHttpRequest;e.open("GET",a,!0);e.responseType="arraybuffer";e.onload=()=>{200==e.status||0==e.status&&e.response?b(e.response):d()};e.onerror=d;e.send(null)}else fetch(a,{credentials:"same-origin"}).then(g=>
g.ok?g.arrayBuffer():Promise.reject(Error(g.status+" : "+g.url))).then(b,d)};c.print||console.log.bind(console);var n=c.printErr||console.error.bind(console);Object.assign(c,ja);ja=null;var p;c.wasmBinary&&(p=c.wasmBinary);var pa,qa=!1,q,r,ra,sa,ta,ua,va;
function wa(){var a=pa.buffer;c.HEAP8=q=new Int8Array(a);c.HEAP16=ra=new Int16Array(a);c.HEAPU8=r=new Uint8Array(a);c.HEAPU16=new Uint16Array(a);c.HEAP32=sa=new Int32Array(a);c.HEAPU32=ta=new Uint32Array(a);c.HEAPF32=ua=new Float32Array(a);c.HEAPF64=va=new Float64Array(a)}var xa=[],za=[],Aa=[];function Ba(){var a=c.preRun.shift();xa.unshift(a)}var t=0,Ca=null,u=null;
function w(a){c.onAbort?.(a);a="Aborted("+a+")";n(a);qa=!0;a=new WebAssembly.RuntimeError(a+". Build with -sASSERTIONS for more info.");ba(a);throw a;}var Da=a=>a.startsWith("data:application/octet-stream;base64,"),oa=a=>a.startsWith("file://"),Ea;function Fa(a){if(a==Ea&&p)return new Uint8Array(p);if(ma)return ma(a);throw"both async and sync fetching of the wasm failed";}
function Ga(a){return p?Promise.resolve().then(()=>Fa(a)):new Promise((b,d)=>{la(a,e=>b(new Uint8Array(e)),()=>{try{b(Fa(a))}catch(e){d(e)}})})}function Ha(a,b,d){return Ga(a).then(e=>WebAssembly.instantiate(e,b)).then(d,e=>{n(`failed to asynchronously prepare wasm: ${e}`);w(e)})}
function Ia(a,b){var d=Ea;return p||"function"!=typeof WebAssembly.instantiateStreaming||Da(d)||oa(d)||fa||"function"!=typeof fetch?Ha(d,a,b):fetch(d,{credentials:"same-origin"}).then(e=>WebAssembly.instantiateStreaming(e,a).then(b,function(g){n(`wasm streaming compile failed: ${g}`);n("falling back to ArrayBuffer instantiation");return Ha(d,a,b)}))}var Ja=a=>{for(;0<a.length;)a.shift()(c)};
function Ka(a,b="i8"){b.endsWith("*")&&(b="*");switch(b){case "i1":return q[a];case "i8":return q[a];case "i16":return ra[a>>1];case "i32":return sa[a>>2];case "i64":w("to do getValue(i64) use WASM_BIGINT");case "float":return ua[a>>2];case "double":return va[a>>3];case "*":return ta[a>>2];default:w(`invalid type for getValue: ${b}`)}}
function x(a){var b="i8";b.endsWith("*")&&(b="*");switch(b){case "i1":q[a]=0;break;case "i8":q[a]=0;break;case "i16":ra[a>>1]=0;break;case "i32":sa[a>>2]=0;break;case "i64":w("to do setValue(i64) use WASM_BIGINT");case "float":ua[a>>2]=0;break;case "double":va[a>>3]=0;break;case "*":ta[a>>2]=0;break;default:w(`invalid type for setValue: ${b}`)}}
var La=(a,b)=>{for(var d=0;d<a.length;++d)q[b++]=a.charCodeAt(d);q[b]=0},z=a=>{for(var b=0,d=0;d<a.length;++d){var e=a.charCodeAt(d);127>=e?b++:2047>=e?b+=2:55296<=e&&57343>=e?(b+=4,++d):b+=3}return b},A=(a,b,d,e)=>{if(!(0<e))return 0;var g=d;e=d+e-1;for(var h=0;h<a.length;++h){var m=a.charCodeAt(h);if(55296<=m&&57343>=m){var v=a.charCodeAt(++h);m=65536+((m&1023)<<10)|v&1023}if(127>=m){if(d>=e)break;b[d++]=m}else{if(2047>=m){if(d+1>=e)break;b[d++]=192|m>>6}else{if(65535>=m){if(d+2>=e)break;b[d++]=
224|m>>12}else{if(d+3>=e)break;b[d++]=240|m>>18;b[d++]=128|m>>12&63}b[d++]=128|m>>6&63}b[d++]=128|m&63}}b[d]=0;return d-g};function Ma(a,b,d){d=Array(0<d?d:z(a)+1);a=A(a,d,0,d.length);b&&(d.length=a);return d}
var Na="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0,B=(a,b)=>{var d=r,e=a+b;for(b=a;d[b]&&!(b>=e);)++b;if(16<b-a&&d.buffer&&Na)return Na.decode(d.subarray(a,b));for(e="";a<b;){var g=d[a++];if(g&128){var h=d[a++]&63;if(192==(g&224))e+=String.fromCharCode((g&31)<<6|h);else{var m=d[a++]&63;g=224==(g&240)?(g&15)<<12|h<<6|m:(g&7)<<18|h<<12|m<<6|d[a++]&63;65536>g?e+=String.fromCharCode(g):(g-=65536,e+=String.fromCharCode(55296|g>>10,56320|g&1023))}}else e+=String.fromCharCode(g)}return e},
Oa={_emscripten_memcpy_js:(a,b,d)=>r.copyWithin(a,b,b+d),emscripten_resize_heap:a=>{var b=r.length;a>>>=0;if(2147483648<a)return!1;for(var d=1;4>=d;d*=2){var e=b*(1+.2/d);e=Math.min(e,a+100663296);var g=Math;e=Math.max(a,e);a:{g=(g.min.call(g,2147483648,e+(65536-e%65536)%65536)-pa.buffer.byteLength+65535)/65536;try{pa.grow(g);wa();var h=1;break a}catch(m){}h=void 0}if(h)return!0}return!1}},C=function(){function a(d){C=d.exports;pa=C.memory;wa();za.unshift(C.__wasm_call_ctors);t--;c.monitorRunDependencies?.(t);
0==t&&(null!==Ca&&(clearInterval(Ca),Ca=null),u&&(d=u,u=null,d()));return C}var b={env:Oa,wasi_snapshot_preview1:Oa};t++;c.monitorRunDependencies?.(t);if(c.instantiateWasm)try{return c.instantiateWasm(b,a)}catch(d){n(`Module.instantiateWasm callback failed with error: ${d}`),ba(d)}Ea||=Da("olm.wasm")?"olm.wasm":c.locateFile?c.locateFile("olm.wasm",l):l+"olm.wasm";Ia(b,function(d){a(d.instance)}).catch(ba);return{}}();
c._olm_get_library_version=(a,b,d)=>(c._olm_get_library_version=C.olm_get_library_version)(a,b,d);c._olm_error=()=>(c._olm_error=C.olm_error)();c._olm_account_last_error=a=>(c._olm_account_last_error=C.olm_account_last_error)(a);c.__olm_error_to_string=a=>(c.__olm_error_to_string=C._olm_error_to_string)(a);c._olm_account_last_error_code=a=>(c._olm_account_last_error_code=C.olm_account_last_error_code)(a);c._olm_session_last_error=a=>(c._olm_session_last_error=C.olm_session_last_error)(a);
c._olm_session_last_error_code=a=>(c._olm_session_last_error_code=C.olm_session_last_error_code)(a);c._olm_utility_last_error=a=>(c._olm_utility_last_error=C.olm_utility_last_error)(a);c._olm_utility_last_error_code=a=>(c._olm_utility_last_error_code=C.olm_utility_last_error_code)(a);c._olm_account_size=()=>(c._olm_account_size=C.olm_account_size)();c._olm_session_size=()=>(c._olm_session_size=C.olm_session_size)();c._olm_utility_size=()=>(c._olm_utility_size=C.olm_utility_size)();
c._olm_account=a=>(c._olm_account=C.olm_account)(a);c._olm_session=a=>(c._olm_session=C.olm_session)(a);c._olm_utility=a=>(c._olm_utility=C.olm_utility)(a);c._olm_clear_account=a=>(c._olm_clear_account=C.olm_clear_account)(a);c._olm_clear_session=a=>(c._olm_clear_session=C.olm_clear_session)(a);c._olm_clear_utility=a=>(c._olm_clear_utility=C.olm_clear_utility)(a);c._olm_pickle_account_length=a=>(c._olm_pickle_account_length=C.olm_pickle_account_length)(a);
c._olm_pickle_session_length=a=>(c._olm_pickle_session_length=C.olm_pickle_session_length)(a);c._olm_pickle_account=(a,b,d,e,g)=>(c._olm_pickle_account=C.olm_pickle_account)(a,b,d,e,g);c._olm_pickle_session=(a,b,d,e,g)=>(c._olm_pickle_session=C.olm_pickle_session)(a,b,d,e,g);c._olm_unpickle_account=(a,b,d,e,g)=>(c._olm_unpickle_account=C.olm_unpickle_account)(a,b,d,e,g);c._olm_unpickle_session=(a,b,d,e,g)=>(c._olm_unpickle_session=C.olm_unpickle_session)(a,b,d,e,g);
c._olm_create_account_random_length=a=>(c._olm_create_account_random_length=C.olm_create_account_random_length)(a);c._olm_create_account=(a,b,d)=>(c._olm_create_account=C.olm_create_account)(a,b,d);c._olm_account_identity_keys_length=a=>(c._olm_account_identity_keys_length=C.olm_account_identity_keys_length)(a);c._olm_account_identity_keys=(a,b,d)=>(c._olm_account_identity_keys=C.olm_account_identity_keys)(a,b,d);c._olm_account_signature_length=a=>(c._olm_account_signature_length=C.olm_account_signature_length)(a);
c._olm_account_sign=(a,b,d,e,g)=>(c._olm_account_sign=C.olm_account_sign)(a,b,d,e,g);c._olm_account_one_time_keys_length=a=>(c._olm_account_one_time_keys_length=C.olm_account_one_time_keys_length)(a);c._olm_account_one_time_keys=(a,b,d)=>(c._olm_account_one_time_keys=C.olm_account_one_time_keys)(a,b,d);c._olm_account_mark_keys_as_published=a=>(c._olm_account_mark_keys_as_published=C.olm_account_mark_keys_as_published)(a);
c._olm_account_max_number_of_one_time_keys=a=>(c._olm_account_max_number_of_one_time_keys=C.olm_account_max_number_of_one_time_keys)(a);c._olm_account_generate_one_time_keys_random_length=(a,b)=>(c._olm_account_generate_one_time_keys_random_length=C.olm_account_generate_one_time_keys_random_length)(a,b);c._olm_account_generate_one_time_keys=(a,b,d,e)=>(c._olm_account_generate_one_time_keys=C.olm_account_generate_one_time_keys)(a,b,d,e);
c._olm_account_generate_fallback_key_random_length=a=>(c._olm_account_generate_fallback_key_random_length=C.olm_account_generate_fallback_key_random_length)(a);c._olm_account_generate_fallback_key=(a,b,d)=>(c._olm_account_generate_fallback_key=C.olm_account_generate_fallback_key)(a,b,d);c._olm_account_fallback_key_length=a=>(c._olm_account_fallback_key_length=C.olm_account_fallback_key_length)(a);c._olm_account_fallback_key=(a,b,d)=>(c._olm_account_fallback_key=C.olm_account_fallback_key)(a,b,d);
c._olm_account_unpublished_fallback_key_length=a=>(c._olm_account_unpublished_fallback_key_length=C.olm_account_unpublished_fallback_key_length)(a);c._olm_account_unpublished_fallback_key=(a,b,d)=>(c._olm_account_unpublished_fallback_key=C.olm_account_unpublished_fallback_key)(a,b,d);c._olm_account_forget_old_fallback_key=a=>(c._olm_account_forget_old_fallback_key=C.olm_account_forget_old_fallback_key)(a);
c._olm_create_outbound_session_random_length=a=>(c._olm_create_outbound_session_random_length=C.olm_create_outbound_session_random_length)(a);c._olm_create_outbound_session=(a,b,d,e,g,h,m,v)=>(c._olm_create_outbound_session=C.olm_create_outbound_session)(a,b,d,e,g,h,m,v);c._olm_create_inbound_session=(a,b,d,e)=>(c._olm_create_inbound_session=C.olm_create_inbound_session)(a,b,d,e);
c._olm_create_inbound_session_from=(a,b,d,e,g,h)=>(c._olm_create_inbound_session_from=C.olm_create_inbound_session_from)(a,b,d,e,g,h);c._olm_session_id_length=a=>(c._olm_session_id_length=C.olm_session_id_length)(a);c._olm_session_id=(a,b,d)=>(c._olm_session_id=C.olm_session_id)(a,b,d);c._olm_session_has_received_message=a=>(c._olm_session_has_received_message=C.olm_session_has_received_message)(a);c._olm_session_describe=(a,b,d)=>(c._olm_session_describe=C.olm_session_describe)(a,b,d);
c._olm_matches_inbound_session=(a,b,d)=>(c._olm_matches_inbound_session=C.olm_matches_inbound_session)(a,b,d);c._olm_matches_inbound_session_from=(a,b,d,e,g)=>(c._olm_matches_inbound_session_from=C.olm_matches_inbound_session_from)(a,b,d,e,g);c._olm_remove_one_time_keys=(a,b)=>(c._olm_remove_one_time_keys=C.olm_remove_one_time_keys)(a,b);c._olm_encrypt_message_type=a=>(c._olm_encrypt_message_type=C.olm_encrypt_message_type)(a);c._olm_encrypt_random_length=a=>(c._olm_encrypt_random_length=C.olm_encrypt_random_length)(a);
c._olm_encrypt_message_length=(a,b)=>(c._olm_encrypt_message_length=C.olm_encrypt_message_length)(a,b);c._olm_encrypt=(a,b,d,e,g,h,m)=>(c._olm_encrypt=C.olm_encrypt)(a,b,d,e,g,h,m);c._olm_decrypt_max_plaintext_length=(a,b,d,e)=>(c._olm_decrypt_max_plaintext_length=C.olm_decrypt_max_plaintext_length)(a,b,d,e);c._olm_decrypt=(a,b,d,e,g,h)=>(c._olm_decrypt=C.olm_decrypt)(a,b,d,e,g,h);c._olm_sha256_length=a=>(c._olm_sha256_length=C.olm_sha256_length)(a);
c._olm_sha256=(a,b,d,e,g)=>(c._olm_sha256=C.olm_sha256)(a,b,d,e,g);c._olm_ed25519_verify=(a,b,d,e,g,h,m)=>(c._olm_ed25519_verify=C.olm_ed25519_verify)(a,b,d,e,g,h,m);c._olm_pk_encryption_last_error=a=>(c._olm_pk_encryption_last_error=C.olm_pk_encryption_last_error)(a);c._olm_pk_encryption_last_error_code=a=>(c._olm_pk_encryption_last_error_code=C.olm_pk_encryption_last_error_code)(a);c._olm_pk_encryption_size=()=>(c._olm_pk_encryption_size=C.olm_pk_encryption_size)();
c._olm_pk_encryption=a=>(c._olm_pk_encryption=C.olm_pk_encryption)(a);c._olm_clear_pk_encryption=a=>(c._olm_clear_pk_encryption=C.olm_clear_pk_encryption)(a);c._olm_pk_encryption_set_recipient_key=(a,b,d)=>(c._olm_pk_encryption_set_recipient_key=C.olm_pk_encryption_set_recipient_key)(a,b,d);c._olm_pk_key_length=()=>(c._olm_pk_key_length=C.olm_pk_key_length)();c._olm_pk_ciphertext_length=(a,b)=>(c._olm_pk_ciphertext_length=C.olm_pk_ciphertext_length)(a,b);
c._olm_pk_mac_length=a=>(c._olm_pk_mac_length=C.olm_pk_mac_length)(a);c._olm_pk_encrypt_random_length=a=>(c._olm_pk_encrypt_random_length=C.olm_pk_encrypt_random_length)(a);c._olm_pk_encrypt=(a,b,d,e,g,h,m,v,J,L,y)=>(c._olm_pk_encrypt=C.olm_pk_encrypt)(a,b,d,e,g,h,m,v,J,L,y);c._olm_pk_decryption_last_error=a=>(c._olm_pk_decryption_last_error=C.olm_pk_decryption_last_error)(a);c._olm_pk_decryption_last_error_code=a=>(c._olm_pk_decryption_last_error_code=C.olm_pk_decryption_last_error_code)(a);
c._olm_pk_decryption_size=()=>(c._olm_pk_decryption_size=C.olm_pk_decryption_size)();c._olm_pk_decryption=a=>(c._olm_pk_decryption=C.olm_pk_decryption)(a);c._olm_clear_pk_decryption=a=>(c._olm_clear_pk_decryption=C.olm_clear_pk_decryption)(a);c._olm_pk_private_key_length=()=>(c._olm_pk_private_key_length=C.olm_pk_private_key_length)();c._olm_pk_generate_key_random_length=()=>(c._olm_pk_generate_key_random_length=C.olm_pk_generate_key_random_length)();
c._olm_pk_key_from_private=(a,b,d,e,g)=>(c._olm_pk_key_from_private=C.olm_pk_key_from_private)(a,b,d,e,g);c._olm_pk_generate_key=(a,b,d,e,g)=>(c._olm_pk_generate_key=C.olm_pk_generate_key)(a,b,d,e,g);c._olm_pickle_pk_decryption_length=a=>(c._olm_pickle_pk_decryption_length=C.olm_pickle_pk_decryption_length)(a);c._olm_pickle_pk_decryption=(a,b,d,e,g)=>(c._olm_pickle_pk_decryption=C.olm_pickle_pk_decryption)(a,b,d,e,g);
c._olm_unpickle_pk_decryption=(a,b,d,e,g,h,m)=>(c._olm_unpickle_pk_decryption=C.olm_unpickle_pk_decryption)(a,b,d,e,g,h,m);c._olm_pk_max_plaintext_length=(a,b)=>(c._olm_pk_max_plaintext_length=C.olm_pk_max_plaintext_length)(a,b);c._olm_pk_decrypt=(a,b,d,e,g,h,m,v,J)=>(c._olm_pk_decrypt=C.olm_pk_decrypt)(a,b,d,e,g,h,m,v,J);c._olm_pk_get_private_key=(a,b,d)=>(c._olm_pk_get_private_key=C.olm_pk_get_private_key)(a,b,d);c._olm_pk_signing_size=()=>(c._olm_pk_signing_size=C.olm_pk_signing_size)();
c._olm_pk_signing=a=>(c._olm_pk_signing=C.olm_pk_signing)(a);c._olm_pk_signing_last_error=a=>(c._olm_pk_signing_last_error=C.olm_pk_signing_last_error)(a);c._olm_pk_signing_last_error_code=a=>(c._olm_pk_signing_last_error_code=C.olm_pk_signing_last_error_code)(a);c._olm_clear_pk_signing=a=>(c._olm_clear_pk_signing=C.olm_clear_pk_signing)(a);c._olm_pk_signing_seed_length=()=>(c._olm_pk_signing_seed_length=C.olm_pk_signing_seed_length)();
c._olm_pk_signing_public_key_length=()=>(c._olm_pk_signing_public_key_length=C.olm_pk_signing_public_key_length)();c._olm_pk_signing_key_from_seed=(a,b,d,e,g)=>(c._olm_pk_signing_key_from_seed=C.olm_pk_signing_key_from_seed)(a,b,d,e,g);c._olm_pk_signature_length=()=>(c._olm_pk_signature_length=C.olm_pk_signature_length)();c._olm_pk_sign=(a,b,d,e,g)=>(c._olm_pk_sign=C.olm_pk_sign)(a,b,d,e,g);c._olm_inbound_group_session_size=()=>(c._olm_inbound_group_session_size=C.olm_inbound_group_session_size)();
c._olm_inbound_group_session=a=>(c._olm_inbound_group_session=C.olm_inbound_group_session)(a);c._olm_clear_inbound_group_session=a=>(c._olm_clear_inbound_group_session=C.olm_clear_inbound_group_session)(a);c._olm_inbound_group_session_last_error=a=>(c._olm_inbound_group_session_last_error=C.olm_inbound_group_session_last_error)(a);c._olm_inbound_group_session_last_error_code=a=>(c._olm_inbound_group_session_last_error_code=C.olm_inbound_group_session_last_error_code)(a);
c._olm_init_inbound_group_session=(a,b,d)=>(c._olm_init_inbound_group_session=C.olm_init_inbound_group_session)(a,b,d);c._olm_import_inbound_group_session=(a,b,d)=>(c._olm_import_inbound_group_session=C.olm_import_inbound_group_session)(a,b,d);c._olm_pickle_inbound_group_session_length=a=>(c._olm_pickle_inbound_group_session_length=C.olm_pickle_inbound_group_session_length)(a);
c._olm_pickle_inbound_group_session=(a,b,d,e,g)=>(c._olm_pickle_inbound_group_session=C.olm_pickle_inbound_group_session)(a,b,d,e,g);c._olm_unpickle_inbound_group_session=(a,b,d,e,g)=>(c._olm_unpickle_inbound_group_session=C.olm_unpickle_inbound_group_session)(a,b,d,e,g);c._olm_group_decrypt_max_plaintext_length=(a,b,d)=>(c._olm_group_decrypt_max_plaintext_length=C.olm_group_decrypt_max_plaintext_length)(a,b,d);
c._olm_group_decrypt=(a,b,d,e,g,h)=>(c._olm_group_decrypt=C.olm_group_decrypt)(a,b,d,e,g,h);c._olm_inbound_group_session_id_length=a=>(c._olm_inbound_group_session_id_length=C.olm_inbound_group_session_id_length)(a);c._olm_inbound_group_session_id=(a,b,d)=>(c._olm_inbound_group_session_id=C.olm_inbound_group_session_id)(a,b,d);c._olm_inbound_group_session_first_known_index=a=>(c._olm_inbound_group_session_first_known_index=C.olm_inbound_group_session_first_known_index)(a);
c._olm_inbound_group_session_is_verified=a=>(c._olm_inbound_group_session_is_verified=C.olm_inbound_group_session_is_verified)(a);c._olm_export_inbound_group_session_length=a=>(c._olm_export_inbound_group_session_length=C.olm_export_inbound_group_session_length)(a);c._olm_export_inbound_group_session=(a,b,d,e)=>(c._olm_export_inbound_group_session=C.olm_export_inbound_group_session)(a,b,d,e);c._olm_outbound_group_session_size=()=>(c._olm_outbound_group_session_size=C.olm_outbound_group_session_size)();
c._olm_outbound_group_session=a=>(c._olm_outbound_group_session=C.olm_outbound_group_session)(a);c._olm_clear_outbound_group_session=a=>(c._olm_clear_outbound_group_session=C.olm_clear_outbound_group_session)(a);c._olm_outbound_group_session_last_error=a=>(c._olm_outbound_group_session_last_error=C.olm_outbound_group_session_last_error)(a);c._olm_outbound_group_session_last_error_code=a=>(c._olm_outbound_group_session_last_error_code=C.olm_outbound_group_session_last_error_code)(a);
c._olm_pickle_outbound_group_session_length=a=>(c._olm_pickle_outbound_group_session_length=C.olm_pickle_outbound_group_session_length)(a);c._olm_pickle_outbound_group_session=(a,b,d,e,g)=>(c._olm_pickle_outbound_group_session=C.olm_pickle_outbound_group_session)(a,b,d,e,g);c._olm_unpickle_outbound_group_session=(a,b,d,e,g)=>(c._olm_unpickle_outbound_group_session=C.olm_unpickle_outbound_group_session)(a,b,d,e,g);
c._olm_init_outbound_group_session_random_length=a=>(c._olm_init_outbound_group_session_random_length=C.olm_init_outbound_group_session_random_length)(a);c._olm_init_outbound_group_session=(a,b,d)=>(c._olm_init_outbound_group_session=C.olm_init_outbound_group_session)(a,b,d);c._olm_group_encrypt_message_length=(a,b)=>(c._olm_group_encrypt_message_length=C.olm_group_encrypt_message_length)(a,b);c._olm_group_encrypt=(a,b,d,e,g)=>(c._olm_group_encrypt=C.olm_group_encrypt)(a,b,d,e,g);
c._olm_outbound_group_session_id_length=a=>(c._olm_outbound_group_session_id_length=C.olm_outbound_group_session_id_length)(a);c._olm_outbound_group_session_id=(a,b,d)=>(c._olm_outbound_group_session_id=C.olm_outbound_group_session_id)(a,b,d);c._olm_outbound_group_session_message_index=a=>(c._olm_outbound_group_session_message_index=C.olm_outbound_group_session_message_index)(a);c._olm_outbound_group_session_key_length=a=>(c._olm_outbound_group_session_key_length=C.olm_outbound_group_session_key_length)(a);
c._olm_outbound_group_session_key=(a,b,d)=>(c._olm_outbound_group_session_key=C.olm_outbound_group_session_key)(a,b,d);c._olm_sas_last_error=a=>(c._olm_sas_last_error=C.olm_sas_last_error)(a);c._olm_sas_last_error_code=a=>(c._olm_sas_last_error_code=C.olm_sas_last_error_code)(a);c._olm_sas_size=()=>(c._olm_sas_size=C.olm_sas_size)();c._olm_sas=a=>(c._olm_sas=C.olm_sas)(a);c._olm_clear_sas=a=>(c._olm_clear_sas=C.olm_clear_sas)(a);
c._olm_create_sas_random_length=a=>(c._olm_create_sas_random_length=C.olm_create_sas_random_length)(a);c._olm_create_sas=(a,b,d)=>(c._olm_create_sas=C.olm_create_sas)(a,b,d);c._olm_sas_pubkey_length=a=>(c._olm_sas_pubkey_length=C.olm_sas_pubkey_length)(a);c._olm_sas_get_pubkey=(a,b,d)=>(c._olm_sas_get_pubkey=C.olm_sas_get_pubkey)(a,b,d);c._olm_sas_set_their_key=(a,b,d)=>(c._olm_sas_set_their_key=C.olm_sas_set_their_key)(a,b,d);c._olm_sas_is_their_key_set=a=>(c._olm_sas_is_their_key_set=C.olm_sas_is_their_key_set)(a);
c._olm_sas_generate_bytes=(a,b,d,e,g)=>(c._olm_sas_generate_bytes=C.olm_sas_generate_bytes)(a,b,d,e,g);c._olm_sas_mac_length=a=>(c._olm_sas_mac_length=C.olm_sas_mac_length)(a);c._olm_sas_calculate_mac_fixed_base64=(a,b,d,e,g,h,m)=>(c._olm_sas_calculate_mac_fixed_base64=C.olm_sas_calculate_mac_fixed_base64)(a,b,d,e,g,h,m);c._olm_sas_calculate_mac=(a,b,d,e,g,h,m)=>(c._olm_sas_calculate_mac=C.olm_sas_calculate_mac)(a,b,d,e,g,h,m);
c._olm_sas_calculate_mac_long_kdf=(a,b,d,e,g,h,m)=>(c._olm_sas_calculate_mac_long_kdf=C.olm_sas_calculate_mac_long_kdf)(a,b,d,e,g,h,m);c._malloc=a=>(c._malloc=C.malloc)(a);c._free=a=>(c._free=C.free)(a);var Pa=a=>(Pa=C._emscripten_stack_restore)(a),Qa=a=>(Qa=C._emscripten_stack_alloc)(a),Ra=()=>(Ra=C.emscripten_stack_get_current)();c.stackAlloc=a=>Qa(a);c.UTF8ToString=(a,b)=>a?B(a,b):"";c.stringToUTF8=(a,b,d)=>A(a,r,b,d);c.intArrayFromString=Ma;c.stringToAscii=La;var Sa;
u=function Ta(){Sa||Ua();Sa||(u=Ta)};
function Ua(){function a(){if(!Sa&&(Sa=!0,c.calledRun=!0,!qa)){Ja(za);aa(c);if(c.onRuntimeInitialized)c.onRuntimeInitialized();if(c.postRun)for("function"==typeof c.postRun&&(c.postRun=[c.postRun]);c.postRun.length;){var b=c.postRun.shift();Aa.unshift(b)}Ja(Aa)}}if(!(0<t)){if(c.preRun)for("function"==typeof c.preRun&&(c.preRun=[c.preRun]);c.preRun.length;)Ba();Ja(xa);0<t||(c.setStatus?(c.setStatus("Running..."),setTimeout(function(){setTimeout(function(){c.setStatus("")},1);a()},1)):a())}}
if(c.preInit)for("function"==typeof c.preInit&&(c.preInit=[c.preInit]);0<c.preInit.length;)c.preInit.pop()();Ua();function D(){var a=c._olm_outbound_group_session_size();this.h=E(a);this.g=c._olm_outbound_group_session(this.h)}function F(a){return function(){var b=a.apply(this,arguments);if(b===k)throw b=(b=c._olm_outbound_group_session_last_error(arguments[0]))?B(b):"",Error("OLM."+b);return b}}D.prototype.free=function(){c._olm_clear_outbound_group_session(this.g);G(this.g)};
D.prototype.pickle=H(function(a){a=I(a);var b=F(c._olm_pickle_outbound_group_session_length)(this.g),d=K(a),e=K(b+1);try{F(c._olm_pickle_outbound_group_session)(this.g,d,a.length,e,b)}finally{for(M(d,a.length),d=0;d<a.length;d++)a[d]=0}return e?B(e,b):""});D.prototype.unpickle=H(function(a,b){a=I(a);var d=K(a);b=I(b);var e=K(b);try{F(c._olm_unpickle_outbound_group_session)(this.g,d,a.length,e,b.length)}finally{for(M(d,a.length),d=0;d<a.length;d++)a[d]=0}});
D.prototype.create=H(function(){var a=F(c._olm_init_outbound_group_session_random_length)(this.g),b=N(a,f);try{F(c._olm_init_outbound_group_session)(this.g,b,a)}finally{M(b,a)}});D.prototype.encrypt=function(a){try{var b=z(a);var d=F(c._olm_group_encrypt_message_length)(this.g,b);var e=E(b+1);A(a,r,e,b+1);var g=E(d+1);F(c._olm_group_encrypt)(this.g,e,b,g,d);x(g+d);return g?B(g,d):""}finally{void 0!==e&&(M(e,b+1),G(e)),void 0!==g&&G(g)}};
D.prototype.session_id=H(function(){var a=F(c._olm_outbound_group_session_id_length)(this.g),b=K(a+1);F(c._olm_outbound_group_session_id)(this.g,b,a);return b?B(b,a):""});D.prototype.session_key=H(function(){var a=F(c._olm_outbound_group_session_key_length)(this.g),b=K(a+1);F(c._olm_outbound_group_session_key)(this.g,b,a);var d=b?B(b,a):"";M(b,a);return d});D.prototype.message_index=function(){return F(c._olm_outbound_group_session_message_index)(this.g)};olm_exports.OutboundGroupSession=D;
function O(){var a=c._olm_inbound_group_session_size();this.h=E(a);this.g=c._olm_inbound_group_session(this.h)}function P(a){return function(){var b=a.apply(this,arguments);if(b===k)throw b=(b=c._olm_inbound_group_session_last_error(arguments[0]))?B(b):"",Error("OLM."+b);return b}}O.prototype.free=function(){c._olm_clear_inbound_group_session(this.g);G(this.g)};
O.prototype.pickle=H(function(a){a=I(a);var b=P(c._olm_pickle_inbound_group_session_length)(this.g),d=K(a),e=K(b+1);try{P(c._olm_pickle_inbound_group_session)(this.g,d,a.length,e,b)}finally{for(M(d,a.length),d=0;d<a.length;d++)a[d]=0}return e?B(e,b):""});O.prototype.unpickle=H(function(a,b){a=I(a);var d=K(a);b=I(b);var e=K(b);try{P(c._olm_unpickle_inbound_group_session)(this.g,d,a.length,e,b.length)}finally{for(M(d,a.length),d=0;d<a.length;d++)a[d]=0}});
O.prototype.create=H(function(a){a=I(a);var b=K(a);try{P(c._olm_init_inbound_group_session)(this.g,b,a.length)}finally{for(M(b,a.length),b=0;b<a.length;b++)a[b]=0}});O.prototype.import_session=H(function(a){a=I(a);var b=K(a);try{P(c._olm_import_inbound_group_session)(this.g,b,a.length)}finally{for(M(b,a.length),b=0;b<a.length;b++)a[b]=0}});
O.prototype.decrypt=H(function(a){try{var b=E(a.length);La(a,b);var d=P(c._olm_group_decrypt_max_plaintext_length)(this.g,b,a.length);La(a,b);var e=E(d+1);var g=K(4);var h=P(c._olm_group_decrypt)(this.g,b,a.length,e,d,g);x(e+h);return{plaintext:e?B(e,h):"",message_index:Ka(g,"i32")}}finally{void 0!==b&&G(b),void 0!==e&&(M(e,h),G(e))}});
O.prototype.session_id=H(function(){var a=P(c._olm_inbound_group_session_id_length)(this.g),b=K(a+1);P(c._olm_inbound_group_session_id)(this.g,b,a);return b?B(b,a):""});O.prototype.first_known_index=H(function(){return P(c._olm_inbound_group_session_first_known_index)(this.g)});O.prototype.export_session=H(function(a){var b=P(c._olm_export_inbound_group_session_length)(this.g),d=K(b+1);F(c._olm_export_inbound_group_session)(this.g,d,b,a);a=d?B(d,b):"";M(d,b);return a});
olm_exports.InboundGroupSession=O;function Va(){var a=c._olm_pk_encryption_size();this.h=E(a);this.g=c._olm_pk_encryption(this.h)}function Q(a){return function(){var b=a.apply(this,arguments);if(b===k)throw b=(b=c._olm_pk_encryption_last_error(arguments[0]))?B(b):"",Error("OLM."+b);return b}}Va.prototype.free=function(){c._olm_clear_pk_encryption(this.g);G(this.g)};Va.prototype.set_recipient_key=H(function(a){a=I(a);var b=K(a);Q(c._olm_pk_encryption_set_recipient_key)(this.g,b,a.length)});
Va.prototype.encrypt=H(function(a){try{var b=z(a);var d=E(b+1);A(a,r,d,b+1);var e=Q(c._olm_pk_encrypt_random_length)();var g=N(e,f);var h=Q(c._olm_pk_ciphertext_length)(this.g,b);var m=E(h+1);var v=Q(c._olm_pk_mac_length)(this.g),J=K(v+1);x(J+v);var L=Q(c._olm_pk_key_length)(),y=K(L+1);x(y+L);Q(c._olm_pk_encrypt)(this.g,d,b,m,h,J,v,y,L,g,e);x(m+h);return{ciphertext:m?B(m,h):"",mac:J?B(J,v):"",ephemeral:y?B(y,L):""}}finally{void 0!==g&&M(g,e),void 0!==d&&(M(d,b+1),G(d)),void 0!==m&&G(m)}});
function R(){var a=c._olm_pk_decryption_size();this.h=E(a);this.g=c._olm_pk_decryption(this.h)}function S(a){return function(){var b=a.apply(this,arguments);if(b===k)throw b=(b=c._olm_pk_decryption_last_error(arguments[0]))?B(b):"",Error("OLM."+b);return b}}R.prototype.free=function(){c._olm_clear_pk_decryption(this.g);G(this.g)};
R.prototype.init_with_private_key=H(function(a){var b=K(a.length);c.HEAPU8.set(a,b);var d=S(c._olm_pk_key_length)(),e=K(d+1);try{S(c._olm_pk_key_from_private)(this.g,e,d,b,a.length)}finally{M(b,a.length)}return e?B(e,d):""});R.prototype.generate_key=H(function(){var a=S(c._olm_pk_private_key_length)(),b=N(a,f),d=S(c._olm_pk_key_length)(),e=K(d+1);try{S(c._olm_pk_key_from_private)(this.g,e,d,b,a)}finally{M(b,a)}return e?B(e,d):""});
R.prototype.get_private_key=H(function(){var a=Q(c._olm_pk_private_key_length)(),b=K(a);S(c._olm_pk_get_private_key)(this.g,b,a);var d=new Uint8Array(new Uint8Array(c.HEAPU8.buffer,b,a));M(b,a);return d});R.prototype.pickle=H(function(a){a=I(a);var b=S(c._olm_pickle_pk_decryption_length)(this.g),d=K(a),e=K(b+1);try{S(c._olm_pickle_pk_decryption)(this.g,d,a.length,e,b)}finally{for(M(d,a.length),d=0;d<a.length;d++)a[d]=0}return e?B(e,b):""});
R.prototype.unpickle=H(function(a,b){a=I(a);var d=K(a),e=I(b),g=K(e);b=S(c._olm_pk_key_length)();var h=K(b+1);try{S(c._olm_unpickle_pk_decryption)(this.g,d,a.length,g,e.length,h,b)}finally{for(M(d,a.length),d=0;d<a.length;d++)a[d]=0}return h?B(h,b):""});
R.prototype.decrypt=H(function(a,b,d){try{var e=z(d);var g=E(e+1);A(d,r,g,e+1);var h=I(a),m=K(h),v=I(b),J=K(v);var L=S(c._olm_pk_max_plaintext_length)(this.g,e);var y=E(L+1);var ya=S(c._olm_pk_decrypt)(this.g,m,h.length,J,v.length,g,e,y,L);x(y+ya);return y?B(y,ya):""}finally{void 0!==y&&(M(y,ya+1),G(y)),void 0!==g&&G(g)}});function Wa(){var a=c._olm_pk_signing_size();this.h=E(a);this.g=c._olm_pk_signing(this.h)}
function Xa(a){return function(){var b=a.apply(this,arguments);if(b===k)throw b=(b=c._olm_pk_signing_last_error(arguments[0]))?B(b):"",Error("OLM."+b);return b}}Wa.prototype.free=function(){c._olm_clear_pk_signing(this.g);G(this.g)};Wa.prototype.init_with_seed=H(function(a){var b=K(a.length);c.HEAPU8.set(a,b);var d=Xa(c._olm_pk_signing_public_key_length)(),e=K(d+1);try{Xa(c._olm_pk_signing_key_from_seed)(this.g,e,d,b,a.length)}finally{M(b,a.length)}return e?B(e,d):""});
Wa.prototype.generate_seed=H(function(){var a=Xa(c._olm_pk_signing_seed_length)(),b=N(a,f),d=new Uint8Array(new Uint8Array(c.HEAPU8.buffer,b,a));M(b,a);return d});Wa.prototype.sign=H(function(a){try{var b=z(a);var d=E(b+1);A(a,r,d,b+1);var e=Xa(c._olm_pk_signature_length)(),g=K(e+1);Xa(c._olm_pk_sign)(this.g,d,b,g,e);return g?B(g,e):""}finally{void 0!==d&&(M(d,b+1),G(d))}});
function T(){var a=c._olm_sas_size(),b=c._olm_create_sas_random_length(),d=N(b,f);this.h=E(a);this.g=c._olm_sas(this.h);c._olm_create_sas(this.g,d,b);M(d,b)}function U(a){return function(){var b=a.apply(this,arguments);if(b===k)throw b=(b=c._olm_sas_last_error(arguments[0]))?B(b):"",Error("OLM."+b);return b}}T.prototype.free=function(){c._olm_clear_sas(this.g);G(this.g)};
T.prototype.get_pubkey=H(function(){var a=U(c._olm_sas_pubkey_length)(this.g),b=K(a+1);U(c._olm_sas_get_pubkey)(this.g,b,a);return b?B(b,a):""});T.prototype.set_their_key=H(function(a){a=I(a);var b=K(a);U(c._olm_sas_set_their_key)(this.g,b,a.length)});T.prototype.is_their_key_set=H(function(){return U(c._olm_sas_is_their_key_set)(this.g)?!0:!1});
T.prototype.generate_bytes=H(function(a,b){a=I(a);var d=K(a),e=K(b);U(c._olm_sas_generate_bytes)(this.g,d,a.length,e,b);return new Uint8Array(new Uint8Array(c.HEAPU8.buffer,e,b))});T.prototype.calculate_mac=H(function(a,b){a=I(a);var d=K(a);b=I(b);var e=K(b),g=U(c._olm_sas_mac_length)(this.g),h=K(g+1);U(c._olm_sas_calculate_mac)(this.g,d,a.length,e,b.length,h,g);return h?B(h,g):""});
T.prototype.calculate_mac_fixed_base64=H(function(a,b){a=I(a);var d=K(a);b=I(b);var e=K(b),g=U(c._olm_sas_mac_length)(this.g),h=K(g+1);U(c._olm_sas_calculate_mac_fixed_base64)(this.g,d,a.length,e,b.length,h,g);return h?B(h,g):""});T.prototype.calculate_mac_long_kdf=H(function(a,b){a=I(a);var d=K(a);b=I(b);var e=K(b),g=U(c._olm_sas_mac_length)(this.g),h=K(g+1);U(c._olm_sas_calculate_mac_long_kdf)(this.g,d,a.length,e,b.length,h,g);return h?B(h,g):""});var E=c._malloc,G=c._free,k;
function N(a,b){var d=Qa(a);b(new Uint8Array(c.HEAPU8.buffer,d,a));return d}function K(a){return"number"==typeof a?N(a,function(b){b.fill(0)}):N(a.length,function(b){b.set(a)})}function I(a){return a instanceof Uint8Array?a:Ma(a,!0)}function H(a){return function(){var b=Ra();try{return a.apply(this,arguments)}finally{Pa(b)}}}function M(a,b){for(;0<b--;)c.HEAP8[a++]=0}function V(){var a=c._olm_account_size();this.h=E(a);this.g=c._olm_account(this.h)}
function W(a){return function(){var b=a.apply(this,arguments);if(b===k)throw b=(b=c._olm_account_last_error(arguments[0]))?B(b):"",Error("OLM."+b);return b}}V.prototype.free=function(){c._olm_clear_account(this.g);G(this.g)};V.prototype.create=H(function(){var a=W(c._olm_create_account_random_length)(this.g),b=N(a,f);try{W(c._olm_create_account)(this.g,b,a)}finally{M(b,a)}});
V.prototype.identity_keys=H(function(){var a=W(c._olm_account_identity_keys_length)(this.g),b=K(a+1);W(c._olm_account_identity_keys)(this.g,b,a);return b?B(b,a):""});V.prototype.sign=H(function(a){var b=W(c._olm_account_signature_length)(this.g);a=I(a);var d=K(a),e=K(b+1);try{W(c._olm_account_sign)(this.g,d,a.length,e,b)}finally{for(M(d,a.length),d=0;d<a.length;d++)a[d]=0}return e?B(e,b):""});
V.prototype.one_time_keys=H(function(){var a=W(c._olm_account_one_time_keys_length)(this.g),b=K(a+1);W(c._olm_account_one_time_keys)(this.g,b,a);return b?B(b,a):""});V.prototype.mark_keys_as_published=H(function(){W(c._olm_account_mark_keys_as_published)(this.g)});V.prototype.max_number_of_one_time_keys=H(function(){return W(c._olm_account_max_number_of_one_time_keys)(this.g)});
V.prototype.generate_one_time_keys=H(function(a){var b=W(c._olm_account_generate_one_time_keys_random_length)(this.g,a),d=N(b,f);try{W(c._olm_account_generate_one_time_keys)(this.g,a,d,b)}finally{M(d,b)}});V.prototype.remove_one_time_keys=H(function(a){W(c._olm_remove_one_time_keys)(this.g,a.g)});V.prototype.generate_fallback_key=H(function(){var a=W(c._olm_account_generate_fallback_key_random_length)(this.g),b=N(a,f);try{W(c._olm_account_generate_fallback_key)(this.g,b,a)}finally{M(b,a)}});
V.prototype.fallback_key=H(function(){var a=W(c._olm_account_fallback_key_length)(this.g),b=K(a+1);W(c._olm_account_fallback_key)(this.g,b,a);return b?B(b,a):""});V.prototype.unpublished_fallback_key=H(function(){var a=W(c._olm_account_unpublished_fallback_key_length)(this.g),b=K(a+1);W(c._olm_account_unpublished_fallback_key)(this.g,b,a);return b?B(b,a):""});V.prototype.forget_old_fallback_key=H(function(){W(c._olm_account_forget_old_fallback_key)(this.g)});
V.prototype.pickle=H(function(a){a=I(a);var b=W(c._olm_pickle_account_length)(this.g),d=K(a),e=K(b+1);try{W(c._olm_pickle_account)(this.g,d,a.length,e,b)}finally{for(M(d,a.length),d=0;d<a.length;d++)a[d]=0}return e?B(e,b):""});V.prototype.unpickle=H(function(a,b){a=I(a);var d=K(a);b=I(b);var e=K(b);try{W(c._olm_unpickle_account)(this.g,d,a.length,e,b.length)}finally{for(M(d,a.length),d=0;d<a.length;d++)a[d]=0}});function X(){var a=c._olm_session_size();this.h=E(a);this.g=c._olm_session(this.h)}
function Y(a){return function(){var b=a.apply(this,arguments);if(b===k)throw b=(b=c._olm_session_last_error(arguments[0]))?B(b):"",Error("OLM."+b);return b}}X.prototype.free=function(){c._olm_clear_session(this.g);G(this.g)};X.prototype.pickle=H(function(a){a=I(a);var b=Y(c._olm_pickle_session_length)(this.g),d=K(a),e=K(b+1);try{Y(c._olm_pickle_session)(this.g,d,a.length,e,b)}finally{for(M(d,a.length),d=0;d<a.length;d++)a[d]=0}return e?B(e,b):""});
X.prototype.unpickle=H(function(a,b){a=I(a);var d=K(a);b=I(b);var e=K(b);try{Y(c._olm_unpickle_session)(this.g,d,a.length,e,b.length)}finally{for(M(d,a.length),d=0;d<a.length;d++)a[d]=0}});X.prototype.create_outbound=H(function(a,b,d){var e=Y(c._olm_create_outbound_session_random_length)(this.g),g=N(e,f);b=I(b);d=I(d);var h=K(b),m=K(d);try{Y(c._olm_create_outbound_session)(this.g,a.g,h,b.length,m,d.length,g,e)}finally{M(g,e)}});
X.prototype.create_inbound=H(function(a,b){b=I(b);var d=K(b);try{Y(c._olm_create_inbound_session)(this.g,a.g,d,b.length)}finally{for(M(d,b.length),a=0;a<b.length;a++)b[a]=0}});X.prototype.create_inbound_from=H(function(a,b,d){b=I(b);var e=K(b);d=I(d);var g=K(d);try{Y(c._olm_create_inbound_session_from)(this.g,a.g,e,b.length,g,d.length)}finally{for(M(g,d.length),a=0;a<d.length;a++)d[a]=0}});
X.prototype.session_id=H(function(){var a=Y(c._olm_session_id_length)(this.g),b=K(a+1);Y(c._olm_session_id)(this.g,b,a);return b?B(b,a):""});X.prototype.has_received_message=function(){return Y(c._olm_session_has_received_message)(this.g)?!0:!1};X.prototype.matches_inbound=H(function(a){a=I(a);var b=K(a);return Y(c._olm_matches_inbound_session)(this.g,b,a.length)?!0:!1});
X.prototype.matches_inbound_from=H(function(a,b){a=I(a);var d=K(a);b=I(b);var e=K(b);return Y(c._olm_matches_inbound_session_from)(this.g,d,a.length,e,b.length)?!0:!1});
X.prototype.encrypt=H(function(a){try{var b=Y(c._olm_encrypt_random_length)(this.g);var d=Y(c._olm_encrypt_message_type)(this.g);var e=z(a);var g=Y(c._olm_encrypt_message_length)(this.g,e);var h=N(b,f);var m=E(e+1);A(a,r,m,e+1);var v=E(g+1);Y(c._olm_encrypt)(this.g,m,e,h,b,v,g);x(v+g);return{type:d,body:v?B(v,g):""}}finally{void 0!==h&&M(h,b),void 0!==m&&(M(m,e+1),G(m)),void 0!==v&&G(v)}});
X.prototype.decrypt=H(function(a,b){try{var d=E(b.length);La(b,d);var e=Y(c._olm_decrypt_max_plaintext_length)(this.g,a,d,b.length);La(b,d);var g=E(e+1);var h=Y(c._olm_decrypt)(this.g,a,d,b.length,g,e);x(g+h);return g?B(g,h):""}finally{void 0!==d&&G(d),void 0!==g&&(M(g,e),G(g))}});X.prototype.describe=H(function(){try{var a=E(256);Y(c._olm_session_describe)(this.g,a,256);return a?B(a):""}finally{void 0!==a&&G(a)}});
function Z(){var a=c._olm_utility_size();this.h=E(a);this.g=c._olm_utility(this.h)}function Ya(a){return function(){var b=a.apply(this,arguments);if(b===k)throw b=(b=c._olm_utility_last_error(arguments[0]))?B(b):"",Error("OLM."+b);return b}}Z.prototype.free=function(){c._olm_clear_utility(this.g);G(this.g)};
Z.prototype.sha256=H(function(a){var b=Ya(c._olm_sha256_length)(this.g);a=I(a);var d=K(a),e=K(b+1);try{Ya(c._olm_sha256)(this.g,d,a.length,e,b)}finally{for(M(d,a.length),d=0;d<a.length;d++)a[d]=0}return e?B(e,b):""});Z.prototype.sha256_bytes=Z.prototype.sha256;Z.prototype.ed25519_verify=H(function(a,b,d){a=I(a);var e=K(a);b=I(b);var g=K(b);d=I(d);var h=K(d);try{Ya(c._olm_ed25519_verify)(this.g,e,a.length,g,b.length,h,d.length)}finally{for(M(g,b.length),a=0;a<b.length;a++)b[a]=0}});
olm_exports.Account=V;olm_exports.Session=X;olm_exports.Utility=Z;olm_exports.PkEncryption=Va;olm_exports.PkDecryption=R;olm_exports.PkSigning=Wa;olm_exports.SAS=T;olm_exports.get_library_version=H(function(){var a=K(3);c._olm_get_library_version(a,a+1,a+2);return[Ka(a,"i8"),Ka(a+1,"i8"),Ka(a+2,"i8")]});moduleRtn=ca;


  return moduleRtn;
}
);
})();
if (typeof exports === 'object' && typeof module === 'object')
  module.exports = Module;
else if (typeof define === 'function' && define['amd'])
  define([], () => Module);
var olmInitPromise;

olm_exports['init'] = function(opts) {
    if (olmInitPromise) return olmInitPromise;

    if (opts) OLM_OPTIONS = opts;

    olmInitPromise = new Promise(function(resolve, reject) {
        onInitSuccess = function() {
            resolve();
        };
        onInitFail = function(err) {
            reject(err);
        };
        Module();
    });
    return olmInitPromise;
};

return olm_exports;

})();

if (typeof(window) !== 'undefined') {
    // We've been imported directly into a browser. Define the global 'Olm' object.
    // (we do this even if module.exports was defined, because it's useful to have
    // Olm in the global scope for browserified and webpacked apps.)
    window["Olm"] = Olm;
}

if (typeof module === 'object') {
    // Emscripten sets the module exports to be its module
    // with wrapped c functions. Clobber it with our higher
    // level wrapper class.
    module.exports = Olm;
}

// @license-end
